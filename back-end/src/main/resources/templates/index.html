<!doctype html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>MGIMSS</title><link rel="manifest" href="/manifest.json"><link rel="shortcut icon" href="/favicon.ico"><link href="./style.css"><script src="js/willesPlay.js" type="text/javascript" charset="utf-8"></script><script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script><script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script><script type="text/javascript" src="https://cdn-hangzhou.goeasy.io/goeasy.js"></script><script type="text/javascript">let goEasy = new GoEasy({
        appkey: 'BS-a877d9d456a5459f982c7dfef47f42d0'
      });
      goEasy.subscribe({
        channel: 'MGIMSS',
        onMessage: function(message){

          let popNotice = function() {
            if (Notification.permission === "granted") {
              let notification = new Notification("Hi ：", {
                body: message.content,
              });
              notification.onclick = function() {
                notification.close();
              };
            }
          };

          if (Notification.permission === "granted") {
            popNotice();
          } else if (Notification.permission !== "denied") {
            Notification.requestPermission(function (permission) {
              popNotice();
            });
          }

        }});</script><link href="/static/css/main.887fd023.css" rel="stylesheet"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"></div><video width="100%" height="100%" id="video" style="display:none"></video><script>var playVideo=document.getElementById("video");playVideo.muted=!0,console.log(playVideo)</script><div id="KeFuDiv" class="KeFuDiv" onmousedown="MoveDiv(KeFuDiv,event)"><img id="luyin" src="/luyin.jpg" class="img-circle" height="70px" width="70px" onmousedown="startRecording()" onmouseup="stopRecord()"></div><script type="text/javascript" src="http://7xnlea.com2.z0.glb.qiniucdn.com/online.js"></script><script type="text/javascript">gID("KeFuDiv").style.top=(document.documentElement.clientHeight-gID("KeFuDiv").offsetHeight)/2+"px",gID("KeFuDiv").style.right=document.documentElement.clientWidth-gID("KeFuDiv").offsetWidth+"px",ScrollDiv("KeFuDiv")</script><style>.KeFuDiv{position:absolute;height:80px;width:80px;color:#fff;font-size:20px;text-align:center;cursor:pointer}.KeFuDiv p{line-height:80px;font-weight:700}</style><script type="text/javascript" src="/static/js/main.078f87d0.js"></script></body><script>var recorder;!function(c){c.URL=c.URL||c.webkitURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var o=function(e,t){(t=t||{}).sampleBits=t.sampleBits||8,t.sampleRate=t.sampleRate||7350,console.log(t.sampleBits),console.log("config.sampleBits"),console.log(t.sampleRate),console.log("config.sampleRate");var n=document.getElementById("video");n.src=c.URL.createObjectURL(e),n.onloadedmetadata=function(e){console.log("nihao44eee4aaaaddda"),n.play()},audioContext=c.AudioContext||c.webkitAudioContext;var r=new audioContext,o=r.createMediaStreamSource(e),a=r.createGain();o.connect(a);var i=r.createScriptProcessor(4096,2,2),s={size:0,buffer:[],inputSampleRate:44100,inputSampleBits:16,outputSampleRate:13800,oututSampleBits:16,input:function(e){this.buffer.push(new Float32Array(e)),this.size+=e.length},compress:function(){for(var e=new Float32Array(this.size),t=0,n=0;n<this.buffer.length;n++)e.set(this.buffer[n],t),t+=this.buffer[n].length;console.log(e);for(var r=parseInt(this.inputSampleRate/this.outputSampleRate),o=e.length/r,a=new Float32Array(o),i=0,s=0;i<o;)a[i]=e[s],s+=r,i++;return a},encodeWAV:function(){var e=Math.min(this.inputSampleRate,this.outputSampleRate),t=Math.min(this.inputSampleBits,this.oututSampleBits),n=this.compress(),r=n.length*(t/8),o=new ArrayBuffer(44+r),a=new DataView(o),i=0,s=function(e){for(var t=0;t<e.length;t++)a.setUint8(i+t,e.charCodeAt(t))};if(s("RIFF"),i+=4,a.setUint32(i,36+r,!0),i+=4,s("WAVE"),i+=4,s("fmt "),i+=4,a.setUint32(i,16,!0),i+=4,a.setUint16(i,1,!0),i+=2,a.setUint16(i,1,!0),i+=2,a.setUint32(i,e,!0),i+=4,a.setUint32(i,1*e*(t/8),!0),i+=4,a.setUint16(i,t/8*1,!0),i+=2,a.setUint16(i,t,!0),i+=2,s("data"),i+=4,a.setUint32(i,r,!0),i+=4,8===t)for(var c=0;c<n.length;c++,i++){var u=(l=Math.max(-1,Math.min(1,n[c])))<0?32768*l:32767*l;u=parseInt(255/(65535/(u+32768))),a.setInt8(i,u,!0)}else for(c=0;c<n.length;c++,i+=2){var l=Math.max(-1,Math.min(1,n[c]));a.setInt16(i,l<0?32768*l:32767*l,!0)}return new Blob([a],{type:"audio/wav"})}};console.log("采样率"),console.log(s),this.start=function(){o.connect(i),i.connect(r.destination)},this.close=function(){r.close()},this.stop=function(){i.disconnect()},this.getBlob=function(){return this.stop(),s.encodeWAV()},this.play=function(e){e.src=c.URL.createObjectURL(this.getBlob())},this.upload=function(e,t){var n=new FormData;n.append("audioData",this.getBlob());var r=new XMLHttpRequest;t&&(r.upload.addEventListener("progress",function(e){t("uploading",e)},!1),r.addEventListener("load",function(e){t("ok",e)},!1),r.addEventListener("error",function(e){t("error",e)},!1),r.addEventListener("abort",function(e){t("cancel",e)},!1)),r.open("POST",e),r.send(n)},i.onaudioprocess=function(e){s.input(e.inputBuffer.getChannelData(0))}};o.throwError=function(e){throw new function(){this.toString=function(){return e}}},o.canRecording=null!=navigator.getUserMedia,o.get=function(n,r){if(n){if(!navigator.getUserMedia)return void o.throwErr('当前<a href="http://www.it165.net/edu/ewl/" target="_blank" class="keylink">浏览器</a>不支持录音功能。');navigator.getUserMedia({audio:!0},function(e){var t=new o(e,r);n(t)},function(e){switch(e.code||e.name){case"PERMISSION_DENIED":case"PermissionDeniedError":o.throwError("用户拒绝提供信息。");break;case"NOT_SUPPORTED_ERROR":case"NotSupportedError":o.throwError('<a href="http://www.it165.net/edu/ewl/" target="_blank" class="keylink">浏览器</a>不支持硬件设备。');break;case"MANDATORY_UNSATISFIED_ERROR":case"MandatoryUnsatisfiedError":o.throwError("无法发现指定的硬件设备。");break;default:o.throwError("无法打开麦克风。异常信息:"+(e.code||e.name))}})}},o.get2=function(n,r){if(n){if(!navigator.getUserMedia)return void o.throwErr('当前<a href="http://www.it165.net/edu/ewl/" target="_blank" class="keylink">浏览器</a>不支持录音功能。');navigator.getUserMedia({audio:!0,video:{width:320,height:320}},function(e){var t=new o(e,r);n(t)},function(e){switch(e.code||e.name){case"PERMISSION_DENIED":case"PermissionDeniedError":o.throwError("用户拒绝提供信息。");break;case"NOT_SUPPORTED_ERROR":case"NotSupportedError":o.throwError('<a href="http://www.it165.net/edu/ewl/" target="_blank" class="keylink">浏览器</a>不支持硬件设备。');break;case"MANDATORY_UNSATISFIED_ERROR":case"MandatoryUnsatisfiedError":o.throwError("无法发现指定的硬件设备。");break;default:o.throwError("无法打开麦克风。异常信息:"+(e.code||e.name))}})}},c.HZRecorder=o}(window);var audio=document.querySelector("audio");function changeluyin1(){document.getElementById("luyin").src="/luyin2.gif"}function changeluyin2(){document.getElementById("luyin").src="/luyin.jpg"}function startRecording(){document.getElementById("luyin").src="/luyin2.gif",HZRecorder.get(function(e){(recorder=e).start()})}function startRecording2(){HZRecorder.get2(function(e){(recorder=e).start()});var e=10,t=setInterval(function(){0==e&&(document.getElementById("picture").click(),console.log("click"),clearInterval(t)),numDiv.innerHTML=e--},1e3)}function obtainRecord(){document.getElementById("luyin").src="/luyin.jpg";var e=recorder.getBlob(),t=new FileReader;t.readAsDataURL(e),t.onload=function(){var e;console.log(t.result),ans=t.result,window.XMLHttpRequest&&(e=new XMLHttpRequest),e.onreadystatechange=function(){4==e.readyState&&e.status},e.open("POST","/webSpeech",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send("sudio="+ans)},recorder.close()}function stopRecord(){document.getElementById("luyin").src="/luyin.jpg",recorder.stop();var e=recorder.getBlob(),t=new FileReader;t.readAsDataURL(e),t.onload=function(){var e;console.log(t.result),ans=t.result,window.XMLHttpRequest&&(e=new XMLHttpRequest),e.onreadystatechange=function(){4==e.readyState&&e.status},e.open("POST","/webSpeech",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send("sudio="+ans)},recorder.close()}function playRecord(){recorder.play(audio)}</script></html>